function getFecha(e){var t=new Date(e),o=t.getDate(),n=t.getFullYear(),r=parseInt(t.getMonth())+1;return o<10&&(o="0"+o),r<10&&(r="0"+r),n+"/"+r+"/"+o}function getHora(e){var t=new Date(e),o=t.getHours(),n=t.getMinutes(),r=t.getSeconds();return o<10&&(o="0"+o),n<10&&(n="0"+n),r<10&&(r="0"+r),o+":"+n}function getFechayHora(e){var t=e.split("T"),o=t[0],n=t[1].split(".")[0];return o.replace(/-/g,"/")+" "+n}!function(){"use strict";angular.module("app",["app.core","app.i18n","app.layout","app.home","app.login","app.ticket","app.booking"])}(),function(){"use strict";angular.module("app.booking",[])}(),function(){"use strict";angular.module("app.core",["ngAnimate","ngAria","ngMessages","oc.lazyLoad","ngMaterial","ui.router","duScroll","ui-notification"])}(),function(){"use strict";angular.module("app.home",[])}(),function(){"use strict";angular.module("app.layout",[])}(),function(){"use strict";angular.module("app.login",[])}(),function(){"use strict";angular.module("app.ticket",[])}(),function(){"use strict";function e(e,t,o,n,r){var i=this;i.listDays=[],i.listRanges=[],i.selectTime=0,i.selectDay=0,i.$onInit=function(){l()};var a=function(e){var t=["Domingo","Lunes","Martes","Miércoles","Jueves","Viernes","Sábado"],o=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],n=new Date(e);return t[n.getDay()]+", "+n.getDate()+" de "+o[n.getMonth()]+" del "+n.getFullYear()},c=function(){if(i.listDays=[],null!==i.listTimes&&i.listTimes.length>0)for(var e=0;e<i.listTimes.length;e++){for(var t=[],o=0;o<i.listTimes[e].ranges.length;o++)t[o]={start_time:i.listTimes[e].ranges[o].start_time,end_time:i.listTimes[e].ranges[o].end_time,hours:"Desde "+getHora(i.listTimes[e].ranges[o].start_time)+" Hasta "+getHora(i.listTimes[e].ranges[o].end_time)};i.listDays[e]={value:a(i.listTimes[e].day).toLowerCase(),display:a(i.listTimes[e].day),ranges:t}}else n.clearAll(),n.error("Error al cargar los dias de reserva.")},l=function(){r.$broadcast("preloader:active"),i.listTimes=[];var e=JSON.parse(localStorage.getItem("branchData")),t=e.id,n=localStorage.getItem("serviceId");i.listTimes=o.getDayBooking(t,n),r.$broadcast("preloader:hide"),c()};i.selectedItemChange=function(){console.log(i.selectDay),i.listRanges=[],i.selectTime=0;for(var e=0;e<i.listDays.length;e++)if(i.listDays[e].value===i.selectDay){for(var t=0;t<i.listDays[e].ranges.length;t++)i.listRanges[t]={value:i.listDays[e].ranges[t].start_time+"*"+i.listDays[e].ranges[t].end_time,display:i.listDays[e].ranges[t].hours};break}},i.save=function(){if(0!==i.selectDay&&0!==i.selectTime){r.$broadcast("preloader:active");var t=JSON.parse(localStorage.getItem("branchData")),a=JSON.parse(localStorage.getItem("loginData")),c=JSON.parse(localStorage.getItem("configData")),l={channel_id:c.channel_id,branch_id:t.id,service_id:localStorage.getItem("serviceId"),customer_id:a.customer_id,doc_type:a.typeDocument.id+"",doc_number:a.document,phone:"+51"+a.cellphone,start_time:i.selectTime.split("*")[0],end_time:i.selectTime.split("*")[1]};o.generateBooking(l).then(function(t){r.$broadcast("preloader:hide"),e.url("/bookings")},function(e){console.log(e),r.$broadcast("preloader:hide"),n.clearAll(),"CustomerBookingRestrictionException"===e.data.type?n.warning("No puede generar otra reserva para el mismo servicio."):n.error("Error al generar la reserva.")})}else n.clearAll(),n.warning("Falta seleccionar campos requeridos.")}}angular.module("app.booking").controller("BookingController",e),e.$inject=["$location","$timeout","BookingService","Notification","$rootScope"]}(),function(){"use strict";function e(e,t){this.getBookings=function(o,n){return n=null!==n&&""!==n?n:"",e({url:t.main.host+"/bookings/",method:"GET",data:null,params:{customer_id:o}}).then(function(e){return e.data},function(e){throw e})},this.getBooking=function(o){return e({method:"get",url:t.main.host+"/bookings/"+o,headers:{accept:"application/json","content-type":"text/plain"},data:null,params:{}}).then(function(e){return e.data},function(e){throw e})},this.generateBooking=function(o){return e({method:"POST",url:t.main.host+"/bookings/",headers:{accept:"application/json","content-type":"application/json"},data:o,params:{}}).then(function(e){return e.data},function(e){throw e})},this.getBranchs=function(o,n){return n=null!==n&&""!==n?n:"",e({url:t.main.host+"/branches/",method:"GET",data:{},params:{customer_id:o,limit:10}}).then(function(e){return e.data},function(e){throw e})},this.getDayBooking=function(e,o){var n=[];return $.ajax({async:!1,type:"GET",url:t.main.host+"/bookings/days",data:{branch_id:e,service_id:o,limit:10},success:function(e){n=e},error:function(e){throw e}}),n},this.deleteBooking=function(o){return e.delete(t.main.host+"/bookings/"+o.id).then(function(e){return e},function(e){throw e})}}angular.module("app.booking").service("BookingService",e),e.$inject=["$http","appConfig"]}(),function(){"use strict";function e(e,t,o,n,r){var i=this;i.listBranchs=null,i.$onInit=function(){c(),a()};var a=function(){r.$broadcast("preloader:active");var e=JSON.parse(localStorage.getItem("loginData")).customer_id;o.getBookings(e,"").then(function(e){r.$broadcast("preloader:hide"),e.length>0?i.listBranchs=e:i.listBranchs=null},function(e){console.log(e),r.$broadcast("preloader:hide"),n.clearAll(),n.error("Error al obtener las reservas.")})};i.getFechBookings=function(e){return getFecha(e)},i.getHoraBookings=function(e){return getHora(e)},i.addBooking=function(){localStorage.setItem("userOption","0"),e.url("/service")},i.cancelBooking=function(e,i){var c=t.confirm().title("Desea cancelar la Reserva?").targetEvent(e).ok("Si").cancel("No");t.show(c).then(function(){r.$broadcast("preloader:active"),o.deleteBooking(i).then(function(e){r.$broadcast("preloader:hide"),a()},function(e){console.log(e),r.$broadcast("preloader:hide"),n.clearAll(),n.error("Error al anular la reserva.")})},function(){n.clearAll()})};var c=function(){var e=parseInt(window.innerWidth);e<=400?i.Screen=["col-xs-12"]:e>=401&&e<=520?i.Screen=["col-xs-offset-1","col-xs-10"]:e>=521&&e<=767?i.Screen=["col-xs-offset-2","col-xs-8"]:e>=768&&e<=890?i.Screen=["col-xs-offset-1","col-xs-10"]:e>=891&&e<=1100?i.Screen=["col-xs-offset-2","col-xs-8"]:e>=1101&&e<=1360?i.Screen=["col-xs-offset-3","col-xs-6"]:e>=1361&&(i.Screen=["col-xs-offset-4","col-xs-4"])}}angular.module("app.booking").controller("BookingsController",e),e.$inject=["$location","$mdDialog","BookingService","Notification","$rootScope"]}(),function(){"use strict";function e(e,t,o){var n=this;n.listBranchs=null;n.navigateTo=function(t,o){localStorage.setItem("branchData",JSON.stringify(t)),e.url("/booking")},function(){o.$broadcast("preloader:active");var e=JSON.parse(localStorage.getItem("loginData")).customer_id;t.getBranchs(e,"").then(function(e){o.$broadcast("preloader:hide"),n.listBranchs=e},function(e){console.log(e),o.$broadcast("preloader:hide"),Notification.clearAll(),Notification.error("Error al obtener las Agencias.")})}()}angular.module("app.booking").controller("BranchController",e),e.$inject=["$location","BookingService","$rootScope"]}(),function(){"use strict";function e(){return{main:{brand:"Tiquete Virtual Banco Popular",name:"BMatic",year:(new Date).getFullYear(),layout:"wide",menu:"vertical",isMenuCollapsed:!1,fixedHeader:!0,fixedSidebar:!0,link:"https://www.hiper.com.pe/",host:"http://52.35.163.246/api/v1"}}}function t(e){e.errorOnUnhandledRejections(!1)}function o(e){var t=e.extendPalette("cyan",{contrastLightColors:"500 600 700 800 900",contrastStrongLightColors:"500 600 700 800 900"}),o=e.extendPalette("light-green",{contrastLightColors:"500 600 700 800 900",contrastStrongLightColors:"500 600 700 800 900"});e.definePalette("cyanAlt",t).definePalette("lightGreenAlt",o),e.theme("default").primaryPalette("teal",{default:"500"}).accentPalette("cyanAlt",{default:"500"}).warnPalette("red",{default:"500"}).backgroundPalette("grey")}function n(e){e.setOptions({delay:5e3,startTop:20,startRight:10,verticalSpacing:20,horizontalSpacing:20,positionX:"center",positionY:"top"})}function r(e,t){e.preAssignBindingsEnabled(!0)}angular.module("app.core").factory("appConfig",[e]).config(["$qProvider",t]).config(["$mdThemingProvider",o]).config(["NotificationProvider",n]).config(["$compileProvider",r])}(),function(){"use strict";function e(e,t,o,n,r){e.main=r.main,e.$watch("main",function(o,n){"horizontal"===o.menu&&"vertical"===n.menu&&t.$broadcast("nav:reset"),!1===o.fixedHeader&&!0===o.fixedSidebar&&(!1===n.fixedHeader&&!1===n.fixedSidebar&&(e.main.fixedHeader=!0,e.main.fixedSidebar=!0),!0===n.fixedHeader&&!0===n.fixedSidebar&&(e.main.fixedHeader=!1,e.main.fixedSidebar=!1)),!0===o.fixedSidebar&&(e.main.fixedHeader=!0),!1===o.fixedHeader&&(e.main.fixedSidebar=!1)},!0),t.$on("$stateChangeSuccess",function(e,t,o){n.scrollTo(0,0)})}angular.module("app").controller("AppCtrl",["$scope","$rootScope","$state","$document","appConfig",e])}(),function(){"use strict";angular.module("app").config(["$ocLazyLoadProvider",function(e){e.config({debug:!1,events:!1,modules:[{name:"fontawesome",files:["bower_components/font-awesome/css/font-awesome.css"]},{name:"weather-icons",files:["bower_components/weather-icons/css/weather-icons.min.css"]},{name:"googlemap",files:["bower_components/ngmap/build/scripts/ng-map.min.js"]}]})}])}(),function(){"use strict";angular.module("app").config(["$stateProvider","$urlRouterProvider","$ocLazyLoadProvider",function(e,t,o){e.state("login",{url:"/login",templateUrl:"app/login/register.html",controller:"RegisterController",controllerAs:"registerCtrl"}).state("main",{url:"/main",templateUrl:"app/home/main.html",controller:"MainController",controllerAs:"mainCtrl"}).state("service",{url:"/service",templateUrl:"app/home/service.html",controller:"ServiceController",controllerAs:"serviceCtrl"}).state("branch",{url:"/branch",templateUrl:"app/booking/branch.html",controller:"BranchController",controllerAs:"branchCtrl"}).state("sector",{url:"/sector",templateUrl:"app/ticket/sector.html",controller:"SectorController",controllerAs:"sectorCtrl"}).state("booking",{url:"/booking",templateUrl:"app/booking/booking.html",controller:"BookingController",controllerAs:"bookingCtrl"}).state("bookings",{url:"/bookings",templateUrl:"app/booking/bookings.html",controller:"BookingsController",controllerAs:"bookingsCtrl"}).state("ticket",{url:"/ticket",templateUrl:"app/ticket/ticket.html",controller:"TicketController",controllerAs:"ticketCtrl",resolve:{deps:["$ocLazyLoad",function(e){return e.load(["googlemap"])}]}}).state("ticketsummary",{url:"/ticketsummary",templateUrl:"app/ticket/ticketsummary.html",controller:"TicketSummaryController",controllerAs:"ticketSummaryCtrl"}).state("tickets",{url:"/tickets",templateUrl:"app/ticket/tickets.html",controller:"TicketsController",controllerAs:"ticketsCtrl"}),t.when("/","/login").otherwise("/login")}])}(),function(){function e(e){e.preferredLanguage("es"),e.useSanitizeValueStrategy(null)}angular.module("app.i18n",["pascalprecht.translate"]).config(["$translateProvider",e])}(),function(){"use strict";function e(){function e(e,t){e.addClass("ui-wave");var o,n,r,i;e.off("click").on("click",function(e){var t=$(this);0===t.find(".ink").length&&t.prepend("<span class='ink'></span>"),o=t.find(".ink"),o.removeClass("wave-animate"),o.height()||o.width()||(n=Math.max(t.outerWidth(),t.outerHeight()),o.css({height:n,width:n})),r=e.pageX-t.offset().left-o.width()/2,i=e.pageY-t.offset().top-o.height()/2,o.css({top:i+"px",left:r+"px"}).addClass("wave-animate")})}return{restrict:"A",compile:e}}function t(){function e(e,t){var o,n;n=function(){var e,r,i,a,c;return c=new Date,e=c.getHours(),r=c.getMinutes(),i=c.getSeconds(),r=o(r),i=o(i),a=e+":"+r+":"+i,t.html(a),setTimeout(n,500)},o=function(e){return e<10&&(e="0"+e),e},n()}return{restrict:"A",link:e}}function o(){return{restrict:"A",compile:function(e,t){return e.on("click",function(e){e.stopPropagation()})}}}function n(){return{restrict:"A",link:function(e,t,o){return t.slimScroll({height:o.scrollHeight||"100%"})}}}angular.module("app.home").directive("uiWave",e).directive("uiTime",t).directive("uiNotCloseOnClick",o).directive("slimScroll",n)}(),function(){"use strict";function e(e,t,o){this.navigateTo=function(t){localStorage.setItem("userOption",t),e.url("/service")};!function(){o.$broadcast("preloader:active"),t.getConfig().then(function(e){o.$broadcast("preloader:hide"),localStorage.setItem("configData",JSON.stringify(e))},function(e){console.error(e),o.$broadcast("preloader:hide")})}()}angular.module("app.home").controller("MainController",e),e.$inject=["$location","MainService","$rootScope"]}(),function(){"use strict";function e(e,t){this.function=void 0,this.getConfig=function(){return e({url:"config/config.json",method:"GET"}).then(function(e){return e.data},function(e){throw e})},this.getServicesTickets=function(o){return e({url:t.main.host+"/tickets/services",method:"GET",params:{channel_id:o}}).then(function(e){return e.data},function(e){throw e})},this.getServicesBookings=function(o){return e({url:t.main.host+"/bookings/services",method:"GET",params:{channel_id:o}}).then(function(e){return e.data},function(e){throw e})}}angular.module("app.home").service("MainService",e),e.$inject=["$http","appConfig"]}(),function(){"use strict";function e(e,t,o,n){var r=this;r.listServices=null,r.optionService="";r.navigateTo=function(t){localStorage.setItem("serviceId",t),"1"===r.optionService?e.url("/ticket"):e.url("/branch")},function(){n.$broadcast("preloader:active"),r.optionService=localStorage.getItem("userOption");var e=JSON.parse(localStorage.getItem("configData"));"1"===r.optionService?t.getServicesTickets(e.channel_id).then(function(e){n.$broadcast("preloader:hide"),r.listServices=e,0===e.length&&(o.clearAll(),o.warning("No hay servicios registrados."))},function(e){console.error(e),n.$broadcast("preloader:hide"),o.clearAll(),o.error("Error al obtener los servicios")}):t.getServicesBookings(e.channel_id).then(function(e){n.$broadcast("preloader:hide"),r.listServices=e,0===e.length&&(o.clearAll(),o.warning("No hay servicios registrados."))},function(e){console.error(e),n.$broadcast("preloader:hide"),o.clearAll(),o.error("Error al obtener los servicios.")})}()}angular.module("app.home").controller("ServiceController",e),e.$inject=["$location","MainService","Notification","$rootScope"]}(),function(){"use strict";function e(){function e(e,t,o){var n=$(t[0]),r=$("#app");n.on("click",function(e){var t="quickview-open";if(o.target)var t=t+"-"+o.target;r.toggleClass(t),e.preventDefault()})}return{restrict:"A",link:e}}function t(e){return{restrict:"A",template:'<span class="bar"></span>',link:function(e,t,o){t.addClass("preloaderbar hide"),e.$on("$stateChangeStart",function(e){t.removeClass("hide").addClass("active")}),e.$on("$stateChangeSuccess",function(e,o,n,r){e.targetScope.$watch("$viewContentLoaded",function(){t.addClass("hide").removeClass("active")})}),e.$on("preloader:active",function(e){t.removeClass("hide").addClass("active")}),e.$on("preloader:hide",function(e){t.addClass("hide").removeClass("active")})}}}angular.module("app.layout").directive("toggleQuickview",e).directive("uiPreloader",["$rootScope",t])}(),function(){function e(){$("#loader-container").fadeOut("slow")}$(window).load(function(){setTimeout(e,1e3)})}(),function(){"use strict";function e(e){function t(t,o,n){var r;r=$("#app"),o.on("click",function(t){return r.hasClass("nav-collapsed-min")?r.removeClass("nav-collapsed-min"):(r.addClass("nav-collapsed-min"),e.$broadcast("nav:reset")),t.preventDefault()})}return{restrict:"A",link:t}}function t(){function e(e,t,o){var n,r,i,a,c,l,s,u,d,p;d=250,s=$(window),a=t.find("ul").parent("li"),a.append('<i class="fa fa-angle-down icon-has-ul-h"></i>'),n=a.children("a"),n.append('<i class="fa fa-angle-down icon-has-ul"></i>'),c=t.children("li").not(a),r=c.children("a"),i=$("#app"),l=$("#nav-container"),n.on("click",function(e){var t,o;if(i.hasClass("nav-collapsed-min")||l.hasClass("nav-horizontal")&&s.width()>=768)return!1;o=$(this),t=o.parent("li"),a.not(t).removeClass("open").find("ul").slideUp(d),t.toggleClass("open").find("ul").stop().slideToggle(d),e.preventDefault()}),r.on("click",function(e){a.removeClass("open").find("ul").slideUp(d)}),e.$on("nav:reset",function(e){a.removeClass("open").find("ul").slideUp(d)}),u=s.width(),p=function(){var e;e=s.width(),e<768&&i.removeClass("nav-collapsed-min"),u<768&&e>=768&&l.hasClass("nav-horizontal")&&a.removeClass("open").find("ul").slideUp(d),u=e},s.resize(function(){var e;clearTimeout(e),e=setTimeout(p,300)})}return{restrict:"A",link:e}}function o(){function e(e,t,o,n){var r,i,a;i=t.find("a"),a=function(){return n.path()},r=function(e,t){return t="#!"+t,angular.forEach(e,function(e){var o,n,r;if(n=angular.element(e),o=n.parent("li"),r=n.attr("href"),o.hasClass("active")&&o.removeClass("active"),0===t.indexOf(r))return o.addClass("active")})},r(i,n.path()),e.$watch(a,function(e,t){if(e!==t)return r(i,n.path())})}return{restrict:"A",controller:["$scope","$element","$attrs","$location",e]}}function n(){function e(e,t,o){t.on("click",function(){return $("#app").toggleClass("on-canvas")})}return{restrict:"A",link:e}}angular.module("app.layout").directive("toggleNavCollapsedMin",["$rootScope",e]).directive("collapseNav",t).directive("highlightActive",o).directive("toggleOffCanvas",n)}(),function(){"use strict";function e(){function e(e,t,o){var n,r;r=function(){return o.path()},n=function(e){switch(t.removeClass("on-canvas"),t.removeClass("body-wide body-err body-lock body-auth"),e){case"/404":case"/500":return t.addClass("body-wide body-err");case"/login":case"/register":return t.addClass("body-wide body-auth");case"/page/lock-screen":return t.addClass("body-wide body-lock")}},n(o.path()),e.$watch(r,function(e,t){if(e!==t)return n(o.path())})}return{restrict:"A",controller:["$scope","$element","$location",e]}}angular.module("app.login").directive("customPage",e)}(),function(){"use strict";function e(){return{restrict:"A",require:"ngModel",link:function(e,t,o,n){var r=function(e){var t=e&&e.replace(/-/g,"");if(("id"===o.phonetype?/^\d{10}$/:/^\d{8}$/).test(t))return t},i=function(e){var t=e&&e.replace(/-/g,""),n="id"===o.phonetype?/^(\d{2})(\d{4})(\d{4})$/:/^(\d{4})(\d{4})$/,r=t&&t.match(n);if(r)return r[1]+"-"+r[2]+("id"===o.phonetype?"-"+r[3]:"")};n.$parsers.push(r),n.$formatters.push(i),t.bind("blur",function(){if("id"===o.phonetype)var r=i(t.val().substr(0,10));else var r=i(t.val().substr(0,8));var a=!!r;a&&(n.$setViewValue(r),n.$render()),n.$setValidity("phoneformat",a),e.$apply()})}}}angular.module("app.login").directive("phoneformat",e)}(),function(){"use strict";function e(e){var t=this;t.selectTypeDocument=null,t.listTypeDocument=[{id:1,name:"Cédula"},{id:2,name:"Carné de extranjería"}];t.login=function(){var o={typeDocument:t.selectTypeDocument,document:t.document,cellphone:t.cellphone,customer_id:t.selectTypeDocument.id+"-"+t.document,username:t.username},n=$("#recaptcha");0===grecaptcha.getResponse().length?($(".msg-error").text("Por favor, compruebe"),n.hasClass("error")||n.addClass("error")):($(".msg-error").text(""),n.removeClass("error"),localStorage.setItem("loginData",JSON.stringify(o)),e.url("/main"))},function(){if(localStorage.getItem("loginData")){var e=JSON.parse(localStorage.getItem("loginData"));console.log(e.cellphone),t.selectTypeDocument=e.typeDocument,t.document=e.document,t.cellphone=e.cellphone,t.username=e.username}}()}angular.module("app.login").controller("RegisterController",e),e.$inject=["$location"]}(),function(){"use strict";function e(e,t){var o=this;o.listSertors=null;var n=null;!function(){if(localStorage.getItem("branchData")){var e=JSON.parse(localStorage.getItem("branchData"));n=e.id,o.listSertors=e.sectors}}()}angular.module("app.ticket").controller("SectorController",e),e.$inject=["$location","$rootScope"]}(),function(){"use strict";function e(e,t,o,n,r){var i=this;i.listBranchs=[],i.branch=i.listBranchs[0],e.getMap("gmap").then(function(e){i.map=e}).catch(function(e){console.error("map error: ",e)});i.showDetail=function(e,t){i.branch=t,i.map.showInfoWindow("foo-iw",t.id)};var a=function(){i.map.hideInfoWindow("foo-iw")};i.clicked=function(e){if(a(),r.$broadcast("preloader:active"),e.sectors.length>1)localStorage.setItem("branchData",JSON.stringify(e)),t.url("/sector");else{var i=JSON.parse(localStorage.getItem("loginData")),c=JSON.parse(localStorage.getItem("configData"));console.log(i.document+"---"+i.cellphone);var l={channel_id:c.channel_id,branch_id:e.id,sector_id:e.sectors[0].id,service_id:localStorage.getItem("serviceId"),status:"ENABLED",customer_id:i.customer_id,doc_type:i.typeDocument.id+"",doc_number:i.document,phone:"+51"+i.cellphone};o.generateTicket(l).then(function(e){r.$broadcast("preloader:hide"),localStorage.setItem("ticketData",JSON.stringify(e)),t.url("/ticketsummary")},function(e){console.log(e),r.$broadcast("preloader:hide"),n.clearAll(),"CustomerTicketRestrictionException"===e.data.type?n.warning("No puede generar otro ticket para el mismo servicio."):n.error("Error al generar ticket!")})}},function(){r.$broadcast("preloader:active"),o.getBranchs().then(function(e){r.$broadcast("preloader:hide"),i.listBranchs=e;for(var t=0;t<i.listBranchs.length;t++)"INACTIVE"===i.listBranchs[t].status?i.listBranchs[t].icon="http://maps.google.com/mapfiles/ms/icons/blue-dot.png":"LOW"===i.listBranchs[t].congestion?i.listBranchs[t].icon="http://maps.google.com/mapfiles/ms/icons/green-dot.png":"MEDIUM"===i.listBranchs[t].congestion?i.listBranchs[t].icon="http://maps.google.com/mapfiles/ms/icons/yellow-dot.png":i.listBranchs[t].icon="http://maps.google.com/mapfiles/ms/icons/red-dot.png"},function(e){console.log(e),r.$broadcast("preloader:hide"),n.clearAll(),n.error("Error al obtener las agencias!")})}()}angular.module("app.ticket").controller("TicketController",e),e.$inject=["NgMap","$location","TicketService","Notification","$rootScope"]}(),function(){"use strict";function e(e,t){function o(){}this.function=o,this.getBranchs=function(o){return e({url:t.main.host+"/branches/",method:"GET",params:{limit:10,latitude:9.932507,longitude:-84.078445,services:localStorage.getItem("serviceId")}}).then(function(e){return e.data},function(e){throw e})},this.generateTicket=function(o){return e({url:t.main.host+"/tickets/",method:"POST",data:JSON.stringify(o)}).then(function(e){return e.data},function(e){throw e})},this.getTickets=function(o){return e({url:t.main.host+"/tickets/",method:"GET",params:{customer_id:o}}).then(function(e){return e.data},function(e){throw e})},this.getTicket=function(o,n){var r=""===n?{}:{fields:n};return console.log("1234123"),e({url:t.main.host+"/tickets/"+o.id,method:"GET",params:r}).then(function(e){return e.data},function(e){throw e})},this.deteleTicket=function(o){return e.delete(t.main.host+"/tickets/"+o.id).then(function(e){return e.data},function(e){throw e})}}angular.module("app.ticket").service("TicketService",e),e.$inject=["$http","appConfig"]}(),function(){"use strict";function e(e,t,o,n,r){var i=this;i.listTickets=null,i.Screen=[],i.updateTimer="",i.$onInit=function(){c(),a()};var a=function(){r.$broadcast("preloader:active");var e=JSON.parse(localStorage.getItem("loginData"));o.getTickets(e.customer_id).then(function(e){r.$broadcast("preloader:hide"),e.length>0?i.listTickets=e:i.listTickets=null},function(e){console.error(e),r.$broadcast("preloader:hide"),n.clearAll(),n.error("Error al obtener los tickets.")})};i.addTicket=function(){localStorage.setItem("userOption","1"),e.url("/service")},i.cancelTicket=function(e,i){var c=t.confirm().title("Desea cancelar el Ticket?").targetEvent(e).ok("Si").cancel("No");t.show(c).then(function(){r.$broadcast("preloader:active"),o.deteleTicket(i).then(function(e){r.$broadcast("preloader:hide"),a()},function(e){console.error(e),r.$broadcast("preloader:hide"),n.clearAll(),404===e.status?n.warning("Ticket no disponible."):n.error("Error al cancelar ticket."),a()})},function(){n.clearAll()})},i.showTimer=function(e,t){i.updateTimer="fa-spin",r.$broadcast("preloader:active");o.getTicket(t,"position,low_estimated_time,high_estimated_time,status").then(function(e){r.$broadcast("preloader:hide"),t.position=e.position,t.low_estimated_time=e.low_estimated_time,t.high_estimated_time=e.high_estimated_time,t.status=e.status,i.updateTimer=""},function(e){console.error(e),r.$broadcast("preloader:hide"),n.clearAll(),404===e.status?n.warning("Ticket no disponible."):n.error("Error al actualizar ticket."),i.updateTimer="",a()})};var c=function(){var e=parseInt(window.innerWidth);e<=400?i.Screen=["col-xs-12"]:e>=401&&e<=520?i.Screen=["col-xs-offset-1","col-xs-10"]:e>=521&&e<=767?i.Screen=["col-xs-offset-2","col-xs-8"]:e>=768&&e<=890?i.Screen=["col-xs-offset-1","col-xs-10"]:e>=891&&e<=1100?i.Screen=["col-xs-offset-2","col-xs-8"]:e>=1101&&e<=1360?i.Screen=["col-xs-offset-3","col-xs-6"]:e>=1361&&(i.Screen=["col-xs-offset-4","col-xs-4"])}}angular.module("app.ticket").controller("TicketsController",e),e.$inject=["$location","$mdDialog","TicketService","Notification","$rootScope"]}(),function(){"use strict";function e(e,t,o,n,r){var i=this;i.updateTimer="",i.printTicket=null,i.Screen=[],i.ticket=null,i.$onInit=function(){c(),a()};var a=function(){if(r.$broadcast("preloader:active"),localStorage.getItem("ticketData")){var e=JSON.parse(localStorage.getItem("ticketData"));i.printTicket=e.print,i.ticket=e}};i.showTimer=function(t,a){i.updateTimer="fa-spin",r.$broadcast("preloader:active");n.getTicket(a,"position,low_estimated_time,high_estimated_time,status").then(function(t){r.$broadcast("preloader:hide"),"WAITING"!==t.status&&e.url("/tickets"),i.ticket.position=t.position,i.ticket.low_estimated_time=t.low_estimated_time,i.ticket.high_estimated_time=t.high_estimated_time,i.updateTimer=""},function(t){console.error(t),r.$broadcast("preloader:hide"),o.clearAll(),404===t.status?(o.warning("Ticket no disponible."),e.url("/tickets")):o.error("Error al actualizar ticket."),i.updateTimer=""})},i.cancelTicket=function(i,a){var c=t.confirm().title("Desea cancelar el Ticket?").targetEvent(i).ok("Si").cancel("No");t.show(c).then(function(){r.$broadcast("preloader:active"),n.deteleTicket(a).then(function(t){r.$broadcast("preloader:hide"),e.url("/tickets")},function(t){console.error(t),r.$broadcast("preloader:hide"),o.clearAll(),404===t.status?(o.warning("Ticket no disponible."),e.url("/tickets")):"CancellationOfTicketNotAllowedException"===t.data.type?(o.warning("No se puede cancelar el Ticket."),e.url("/tickets")):o.error("Error al cancelar ticket.")})},function(){o.clearAll()})};var c=function(){var e=parseInt(window.innerWidth);e<=400?i.Screen=["col-xs-12"]:e>=401&&e<=520?i.Screen=["col-xs-offset-1","col-xs-10"]:e>=521&&e<=767?i.Screen=["col-xs-offset-2","col-xs-8"]:e>=768&&e<=890?i.Screen=["col-xs-offset-1","col-xs-10"]:e>=891&&e<=1100?i.Screen=["col-xs-offset-2","col-xs-8"]:e>=1101&&e<=1360?i.Screen=["col-xs-offset-3","col-xs-6"]:e>=1361&&(i.Screen=["col-xs-offset-4","col-xs-4"])}}angular.module("app.ticket").controller("TicketSummaryController",e),e.$inject=["$location","$mdDialog","Notification","TicketService","$rootScope"]}();